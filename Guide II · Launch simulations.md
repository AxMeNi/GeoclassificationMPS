# Guide II  ·  LAUNCH SIMULATIONS
This guide explain how to launch a simulation on a personal computer
## II. 1. Install the environment
- Download the **.yml** file 
## II. 2. Place the data in a folder
### ⮕ The NumPy (.npy) format
- All the raw data provided to the project must be in a form of 2D numpy arrays.
- All the data files must be loaded in the NumPy format (see "[.npy](https://numpy.org/devdocs/reference/generated/numpy.lib.format.html)" for more information about the .npy format).
- This format is used for its simplicity and its ubiquity.
- These NumPy files must have the same dimensions and correspond to what is referred to as the Data Grid (DG).
### ⮕ The CSV (.csv) file
- All data files used must be meticulously recorded in a .csv file, similar to the one available in the [data](https://github.com/AxMeNi/GeoclassificationMPS/tree/main/data) folder.
- The validity of the provided information and data is verified before each simulation.

## II. 3. Provide the parameters
All the parameters related to the simulations can be changed in the INTERFACE.PY script.
- NOTE: To modify the plot style and the generic textual information displayed on the plot, use the DISPLAY_FUNCTIONS.py script.
- NOTE : For the following parameters :
  - `seed`
  - `ti_pct_area`
  - `ti_nshapes`
  - `nRandomTICDsets`
  - `output_dir`
  They will be successively prompted when excuting the Python file with the command 
  ```shell
  python path/to/main.py -s
  ```
  
### ⮕ General parameters
- All parameters related to the data are stored in the .csv file. Therefore, the first parameter to specify is the path to this CSV file.
- Specify a list of`seed` for randomization that will be used for all random processes.
- The `novalue` parameter corresponds to the value in the .npy files which represents an absence of data. `NaN` values are not accepted in the file.
### ⮕ TI parameters
- NOTE : In this section, a parameter which has no value must be set to None.
- There are 3 principal methods to create the TIs via the parameter `ti_methods` :
  - **DependentCircles** : The TI is generated by partially masking the Data Grid (DG). The resulting TI retains the same dimensions as the DG but is only partially populated with data. The exposed data within the TI takes the shape of disks.
  - **DependentSquares** : Same as DependentCircles but with squares.
  - **DependentSquares** : To create multiple TIs. In this case, each square of uncovered data will correspond to a separate TI. Instead of having multiple squares of uncovered data within a single TI, each square will be assigned to a different TI. Consequently, the number of squares will be equal to the number of TIs. The percentage of uncovered data from the Data Grid (DG) will be evenly distributed across all the TIs. For example, if the total uncovered data represents 55% of the DG and there are two squares, then each TI will contain 55/2% of the DG's data.

  These methods require the parameter `ti_pct_area` and `ti_nshapes` to be specified.
- The last method **ReducedTiSg** is for making smaller simulations by partially using the DG to create a smaller TI and a smaller Simulation Grid (SG).
  - `pct_ti_sg_overlap`, `pct_sg`, `pct_ti`, `cc_sg`, `rr_sg`, `cc_ti`, `rr_ti` need to be specified when this parameter is set.
  - This method can considerably increase the computation time, as it relies on iterating through all possible configurations for the desired parameters. Use with caution.
### ⮕ DeeSse simulation parameters
See the official documentation of [geone](https://github.com/randlab/geone/blob/master/docs/source/notebooks/ex_deesse_01_basics.ipynb) for further explanations.
### ⮕ Output parameters
- `saveOutput` : boolean to specify if the [output object of DeeSse](https://github.com/randlab/geone/blob/master/src/geone/deesseinterface.py#L5367) will be saved or not. It is recommended to save the output if further work will be done on the results.
- `output_directory` : path to the output directory.
- `deesse_output_folder` : folder where Deesse output is stored.
- `prefix_deesse_output` : prefix for Deesse simulation files.
- `plot_output_folder` : name of the folder for storing plot outputs.
- `prefix_histogram_dissimilarity` : prefix for Jensen-Shannon divergence histograms.
- `prefix_entropy` : prefix for entropy-related outputs.
- `prefix_simvar_histograms` : prefix for simulation variable histograms.
- `prefix_topological_adjacency` : prefix for topological adjacency outputs.
- `prefix_proportions` : prefix for proportion-related data.
- `prefix_std_deviation` : prefix for standard deviation results.
- `reference_var` : reference variable (a path to **.npy** file).
### ⮕ Shorten simulation parameter
The line :
```python 
shorten = False
```
must always remain as is. The shorter simulation is a WIP.
### ⮕ Remove inapproriate paragraph
- Unless a new function was created, it is required to remove the paragraph "MOVE THAT INTO A FUNCTION" to run the program:
```python
    auxTI_var = {key: value for key, value in auxTI_var_temp.items() if key in arg_aux_vars}
    auxSG_var = {key: value for key, value in auxSG_var_temp.items() if key in arg_aux_vars}
    outputVarFlag = {key: value for key, value in outputVarFlag.items() if key in arg_aux_vars}
    outputVarFlag["grid_geo"]=True
    names_var = [["grid_geo"],arg_aux_vars,arg_aux_vars,[]]
    types_var[1], types_var[2] = types_var[1][:len(arg_aux_vars)], types_var[2][:len(arg_aux_vars)]
```
- This paragraph is only to be used when a design of experiment (DOE) is provided. See Guide IV for more information related to simulations following a DOE.

## II. 4. Chose appropriate titles for the figures
- It is appropriate to adjust the figure names in LAUNCHER.PY to fit the problem being studied, if necessary.
- Other changes can be done in the script DISPLAY_FUNCTIONS.PY.
## II. 5. Launch simulations
Once all parameters and titles are set, write in your terminal :
```shell
python path/to/main.py -s
```
And provide every desired parameters successively.